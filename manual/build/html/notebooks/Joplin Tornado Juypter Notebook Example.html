

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Hazard, Data, and Fragility &mdash; IN-CORE Manual 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Seaside Example Notebook 1: Multi-Hazard Building Damage" href="Notebook1_SeasideBuildingDamage.html" />
    <link rel="prev" title="Example Notebooks" href="../notebooks.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> IN-CORE Manual
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../account.html">IN-CORE Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyincore.html">pyIncore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../incore_lab.html">IN-CORE Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webtools.html">IN-CORE Web Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials and Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Example Notebooks</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1. Hazard, Data, and Fragility</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#1.1.-Tornado-Path">1.1. Tornado Path</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.2.-Building-Archetypes">1.2. Building Archetypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#1.3-Fragility-Curves">1.3 Fragility Curves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#2.-Infrastructure-Damage-Analysis">2. Infrastructure Damage Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#2.1.-Buildings-Damage">2.1. Buildings Damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.2.-Electrical-Power-Facility---Substations-Damage">2.2. Electrical Power Facility - Substations Damage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.3.-Electrical-Power-Facility---Poles-Damage">2.3. Electrical Power Facility - Poles Damage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#3.-Monte-Carlo-Simulation">3. Monte Carlo Simulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#3.1.-Building-Failure-Probability">3.1. Building Failure Probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.2.-Building-Damage-Spatial-Distribution-Results">3.2. Building Damage Spatial Distribution Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#4.-Infrastructure-Functionality-Analysis">4. Infrastructure Functionality Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#4.1.-Building-Functionality-Probability">4.1. Building Functionality Probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.2.-Building-Functionality-Spatial-Distribution-Results">4.2. Building Functionality Spatial Distribution Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="#4.3-Physical-Service-Resilience-Metrics">4.3 Physical Service Resilience Metrics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#5.-Economic-analysis">5. Economic analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#5.1.-Computable-General-Equilibrium-(CGE)-Model">5.1. Computable General Equilibrium (CGE) Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#5.2.-Economic-Resilience-Metrics">5.2. Economic Resilience Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Percent-Reduction-of-Domestic-Supply"><em>Percent Reduction of Domestic Supply</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Percent-Reduction-of-Household-Income"><em>Percent Reduction of Household Income</em></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Percent-Reduction-of-Employment"><em>Percent Reduction of Employment</em></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#6.-Sociological-Analysis">6. Sociological Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#6.1.-Population-Dislocation-Model">6.1. Population Dislocation Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#6.2.-Sociological-Resilience-Metrics">6.2. Sociological Resilience Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Percent-of-Population-Dislocation"><em>Percent of Population Dislocation</em></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#7.-References">7. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="Notebook1_SeasideBuildingDamage.html">Seaside testbed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks_other.html">Other examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">Technical References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgement.html">Acknowledgement</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IN-CORE Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../notebooks.html">Example Notebooks</a> &raquo;</li>
        
      <li>1. Hazard, Data, and Fragility</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/Joplin Tornado Juypter Notebook Example.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p>###</p>
<center><p>Joplin Tornado Example</p>
</center><p>Please note that you might need additional dependencies to run this notebook, such as <a class="reference external" href="https://anaconda.org/conda-forge/geopandas">geopandas</a> and <a class="reference external" href="https://anaconda.org/conda-forge/contextily">contextily</a></p>
<ul class="simple">
<li><p>Tornadoes occur at a high frequency in the United States compared with other natural hazards such as earthquakes and tsunamis but have a substantially smaller footprint. Even a single high-intensity tornado can result in high casualty rates and catastrophic economic losses and social consequences, particularly for small to medium communities.</p></li>
<li><p>The city of Joplin, Missouri, USA, was hit by an EF-5 tornado on May 22, 2011. The National Institute of Standards and Technology (NIST) conducted a technical investigation of this devastating event which can be found at: <a class="reference external" href="https://nvlpubs.nist.gov/nistpubs/NCSTAR/NIST.NCSTAR.3.pdf">https://nvlpubs.nist.gov/nistpubs/NCSTAR/NIST.NCSTAR.3.pdf</a> . The Center for Risk-Based Community Resilience Planning simulated this event for buildings and the electrical power network of Joplin in IN-CORE. This Juypter Notebook provides an example of how to use IN-CORE.</p></li>
<li><p>The initial damage prediction utilized the tornado path, tornado fragility curves representative of a 19- archetype building dataset, and EPN datasets. Generic tornado paths are also available in IN-CORE, or a user defined tornado path is possible.</p></li>
<li><p>The functionality of the infrastructure was linked with a computable general equilibrium (CGE) economics model that computes specific community resilience metrics in economic terms. A population dislocation model provides resilience metrics related to socio-demographics such as population dislocation as a function of income or race/ethnicity.</p></li>
<li><p>This example demonstrates how users interact with the IN-CORE computational environment.</p></li>
</ul>
<p>*This notebook was created by Lisa Wang, supervised by Professor John W. van de Lindt, with the help of the NCSA team (Jong Sung Lee, Chris Navarro, Diego Calderon, Chen Wang, Michal Ondrejcek, Gowtham Naraharisetty, and Yong Wook Kim). The population disclocation model was developed by Nathanael Rosenheim and the CGE model portion provided by Brad Hartman under the supervision of Professor Harvey Cutler.</p>
<div class="section" id="1.-Hazard,-Data,-and-Fragility">
<h1>1. Hazard, Data, and Fragility<a class="headerlink" href="#1.-Hazard,-Data,-and-Fragility" title="Permalink to this headline">¶</a></h1>
<p>This section introduces the input for the infrastructure damage analysis including the tornado path, building dataset, and building fragility curves for tornado.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># This cell is used to import python libraries to visualize the analysis outputs.</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">contextily</span> <span class="k">as</span> <span class="nn">ctx</span>
</pre></div>
</div>
</div>
<div class="section" id="1.1.-Tornado-Path">
<h2>1.1. Tornado Path<a class="headerlink" href="#1.1.-Tornado-Path" title="Permalink to this headline">¶</a></h2>
<p>This figure shows the 2011 Joplin tornado path with EF zones provided in the legend. The tornado path represents the wind speed within the vortex (multi-vortex in the case of Joplin) that was estimated to have EF5 wind speeds of more than 200 mph, reducing to EF4 wind speeds as the areas move outward from the vortex, and eventually reaching EF1 zone. (Attary et al. 2018)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;5d07cbe9b9219c065b819103/joplin_path_wgs84.shp&#39;</span><span class="p">)</span>
<span class="n">shp_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="n">tornado</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shp_path</span><span class="p">)</span>
<span class="n">tornado</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">tornado</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;ef_rating&#39;</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/diegoc/.local/lib/python3.7/site-packages/pyproj/transformer.py:92: UserWarning:

`from_crs` is deprecated and will be removed in 2.2.0. Please use `from_proj` instead.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_13_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_13_1.png" />
</div>
</div>
</div>
<div class="section" id="1.2.-Building-Archetypes">
<h2>1.2. Building Archetypes<a class="headerlink" href="#1.2.-Building-Archetypes" title="Permalink to this headline">¶</a></h2>
<p>The 19 archetype buildings are used herein to represent the Joplin community. The selected building archetypes consider building characteristics such as footprint area, roof structure, number of stories, and so on. (Attary et al. 2018, Memari et al. 2018)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Images/Joplin building archetypes.png&#39;</span><span class="p">)</span>  <span class="c1"># The layout of the building dataset shown in GIS software.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x1406e04a8&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_16_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_16_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;joplin_bldg_inventory_v6_LW/joplin_bldg_inventory_v6.shp&#39;</span><span class="p">)</span>
<span class="n">shp_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

<span class="n">building</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shp_path</span><span class="p">)</span>  <span class="c1"># The layout of the building dataset shown in Python.</span>
<span class="n">building</span> <span class="o">=</span> <span class="n">building</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">building</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;types&#39;</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/diegoc/.local/lib/python3.7/site-packages/pyproj/transformer.py:92: UserWarning:

`from_crs` is deprecated and will be removed in 2.2.0. Please use `from_proj` instead.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_17_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_17_1.png" />
</div>
</div>
</div>
<div class="section" id="1.3-Fragility-Curves">
<h2>1.3 Fragility Curves<a class="headerlink" href="#1.3-Fragility-Curves" title="Permalink to this headline">¶</a></h2>
<p>The fragility curves for these 19 building types in the four damage states are shown below, which covers the entire range of wind speeds associated with tornadoes (Attary et al. 2018, Memari et al. 2018).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img_DS1</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Images/DS1.png&#39;</span><span class="p">)</span>  <span class="c1"># Damage State 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_DS1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x110a844a8&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_20_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_20_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img_DS2</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Images/DS2.png&#39;</span><span class="p">)</span>  <span class="c1"># Damage State 2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_DS2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x1107fe710&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_21_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_21_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img_DS3</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Images/DS3.png&#39;</span><span class="p">)</span>  <span class="c1"># Damage State 3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_DS3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x10ffd44e0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_22_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_22_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img_DS4</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Images/DS4.png&#39;</span><span class="p">)</span>  <span class="c1"># Damage State 4</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_DS4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x10ffa94e0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_23_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_23_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="2.-Infrastructure-Damage-Analysis">
<h1>2. Infrastructure Damage Analysis<a class="headerlink" href="#2.-Infrastructure-Damage-Analysis" title="Permalink to this headline">¶</a></h1>
<p>The models in this section implement the prediction of community-level damage to the buildings and Electric Power Network (EPN) for the 2011 Joplin tornado.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyincore</span> <span class="k">import</span> <span class="n">IncoreClient</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">IncoreClient</span><span class="p">()</span>  <span class="c1"># The authentication service validates username/password and</span>
                         <span class="c1"># approves users to access to other services.</span>
</pre></div>
</div>
</div>
<div class="section" id="2.1.-Buildings-Damage">
<h2>2.1. Buildings Damage<a class="headerlink" href="#2.1.-Buildings-Damage" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.buildingdamage</span> <span class="k">import</span> <span class="n">BuildingDamage</span>  <span class="c1"># Import building damage module integrated into Pyincore.</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bldg_dmg</span> <span class="o">=</span> <span class="n">BuildingDamage</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">hazard_type</span> <span class="o">=</span> <span class="s2">&quot;tornado&quot;</span>
<span class="n">hazard_id</span> <span class="o">=</span> <span class="s2">&quot;5d07cbeab9219c065b080930&quot;</span>  <span class="c1"># The simulated EF-5 tornado shows geographical locations and the range</span>
                                        <span class="c1"># of wind speed of tornado hazard in Joplin.</span>

<span class="n">mapping_id</span> <span class="o">=</span> <span class="s2">&quot;5d8942dfb9219c068ea795ea&quot;</span>  <span class="c1"># Create a mapping to assign tornado fragilities to 19 building archetypes.</span>

<span class="n">bldg_dataset_id</span> <span class="o">=</span> <span class="s2">&quot;5d4c61a2b9219c0689a397c9&quot;</span>  <span class="c1"># Load the Joplin building dataset, which is a package of GIS files.</span>

<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span> <span class="n">bldg_dataset_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Enter username: diegoac2
Enter password: ········
Dataset already exists locally. Reading from local cache.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Joplin_bldg_dmg_result&quot;</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;mapping_id&quot;</span><span class="p">,</span> <span class="n">mapping_id</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_type&quot;</span><span class="p">,</span> <span class="n">hazard_type</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_id&quot;</span><span class="p">,</span> <span class="n">hazard_id</span><span class="p">)</span>
<span class="n">bldg_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># Define the result name, etc., and choose the number of CPU locally</span>
                                      <span class="c1"># to run the model parallelly.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bldg_dmg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the building damage module to get building damage results for Joplin in a .csv file format.</span>
                         <span class="c1"># The building damage results herein are referred to fragilities at three damage states (moderate,</span>
                         <span class="c1"># heavy, complete) for 28152 buildings located in Joplin that fall within the tornado path or not.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</div>
<div class="section" id="2.2.-Electrical-Power-Facility---Substations-Damage">
<h2>2.2. Electrical Power Facility - Substations Damage<a class="headerlink" href="#2.2.-Electrical-Power-Facility---Substations-Damage" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.epfdamage.epfdamage</span> <span class="k">import</span> <span class="n">EpfDamage</span> <span class="c1"># Import epf damage module integrated into Pyincore.</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hazard_type</span> <span class="o">=</span> <span class="s2">&quot;tornado&quot;</span>
<span class="n">hazard_id</span> <span class="o">=</span> <span class="s2">&quot;5d07cbeab9219c065b080930&quot;</span>  <span class="c1"># The simulated EF-5 tornado shows geographical locations and the range</span>
                                        <span class="c1"># of wind speed of tornado hazard in Joplin.</span>
<span class="n">epf_substations_id</span> <span class="o">=</span> <span class="s2">&quot;5d92355bb9219c06ae7e386a&quot;</span>

<span class="n">mapping_id</span> <span class="o">=</span> <span class="s2">&quot;5d8a326fb9219c068ea798e7&quot;</span>  <span class="c1"># Create a mapping to assign tornado fragilities to substations.</span>

<span class="n">epf_dmg</span> <span class="o">=</span> <span class="n">EpfDamage</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">epf_dmg</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;epfs&quot;</span><span class="p">,</span> <span class="n">epf_substations_id</span><span class="p">)</span>
                               <span class="c1"># Load the Joplin substations dataset, which is a package of GIS files.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset already exists locally. Reading from local cache.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Joplin_epf_substations_dmg_result&quot;</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;mapping_id&quot;</span><span class="p">,</span> <span class="n">mapping_id</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_type&quot;</span><span class="p">,</span> <span class="n">hazard_type</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_id&quot;</span><span class="p">,</span> <span class="n">hazard_id</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;fragility_key&quot;</span><span class="p">,</span> <span class="s2">&quot;substations&quot;</span><span class="p">)</span>  <span class="c1"># Define the result name, etc., and choose the number</span>
                                                       <span class="c1"># of CPU locally to run the model parallelly.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">epf_dmg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the EPF damage module to get substations damage results for Joplin in a .csv file format. The</span>
                        <span class="c1"># substations damage results herein are referred to fragilities at four damage states (insignificant,</span>
                        <span class="c1"># moderate, extensive, complete) for 18 substations located in Joplin that fall within the tornado</span>
                        <span class="c1"># path or not.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</div>
<div class="section" id="2.3.-Electrical-Power-Facility---Poles-Damage">
<h2>2.3. Electrical Power Facility - Poles Damage<a class="headerlink" href="#2.3.-Electrical-Power-Facility---Poles-Damage" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hazard_type</span> <span class="o">=</span> <span class="s2">&quot;tornado&quot;</span>
<span class="n">hazard_id</span> <span class="o">=</span> <span class="s2">&quot;5d07cbeab9219c065b080930&quot;</span>  <span class="c1"># The simulated EF-5 tornado shows geographical locations and the range</span>
                                        <span class="c1"># of wind speed of tornado hazard in Joplin.</span>
<span class="n">epf_poles_id</span> <span class="o">=</span> <span class="s2">&quot;5d923daab9219c06ae84afb0&quot;</span>  <span class="c1"># Load the Joplin poles dataset, which is a package of GIS files.</span>

<span class="n">mapping_id</span> <span class="o">=</span> <span class="s2">&quot;5d8a326fb9219c068ea798e7&quot;</span>  <span class="c1"># Create a mapping to assign tornado fragilities to poles.</span>

<span class="n">epf_dmg</span> <span class="o">=</span> <span class="n">EpfDamage</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">epf_dmg</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;epfs&quot;</span><span class="p">,</span> <span class="n">epf_poles_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset already exists locally. Reading from local cache.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;Joplin_epf_poles_dmg_result&quot;</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;mapping_id&quot;</span><span class="p">,</span> <span class="n">mapping_id</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_type&quot;</span><span class="p">,</span> <span class="n">hazard_type</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;hazard_id&quot;</span><span class="p">,</span> <span class="n">hazard_id</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">epf_dmg</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;fragility_key&quot;</span><span class="p">,</span> <span class="s2">&quot;poles&quot;</span><span class="p">)</span>  <span class="c1"># Define the result name, etc., and choose the number</span>
                                                 <span class="c1"># of CPU locally to run the model parallelly.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">epf_dmg</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the EPF damage module to get poles damage results for Joplin in a .csv file format. The poles</span>
                        <span class="c1"># damage results herein are referred to fragilities at four damage states (insignificant, moderate,</span>
                        <span class="c1"># extensive, complete) for 23857 poles located in Joplin that fall within the tornado path or not.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="section" id="3.-Monte-Carlo-Simulation">
<h3>3. Monte Carlo Simulation<a class="headerlink" href="#3.-Monte-Carlo-Simulation" title="Permalink to this headline">¶</a></h3>
<p>Researchers can use Monte Carlo Simulation to estimate the probability of each building being in a particular damage state. This example uses 500 iterations to determine the failure probability of buildings reaching damage state 2, damage state 3, and damage state 4. Users can run 10000 samples or even more for a more accurate Monte Carlo Simulation to determine the building failure probabilities. Note that this takes several minutes and we are working on developing a more efficient algorithm.</p>
</div>
</div>
<div class="section" id="3.1.-Building-Failure-Probability">
<h2>3.1. Building Failure Probability<a class="headerlink" href="#3.1.-Building-Failure-Probability" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.montecarlofailureprobability</span> <span class="k">import</span> <span class="n">MonteCarloFailureProbability</span>
                                                  <span class="c1"># Import Monte Carlo failure probability module integrated into Pyincore.</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mc</span> <span class="o">=</span> <span class="n">MonteCarloFailureProbability</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;damage&quot;</span><span class="p">,</span> <span class="s2">&quot;5dbc9525b9219c06dd282637&quot;</span><span class="p">)</span>
                              <span class="c1">#  Load the Joplin building damage results dataset generated from the previous model as an input.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset already exists locally. Reading from local cache.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mc</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="s2">&quot;tornado_mc_failure_probability_buildings&quot;</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_cpu&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_samples&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">mc</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;damage_interval_keys&quot;</span><span class="p">,</span>                   <span class="c1"># Define the damage states and failure states individually.</span>
                 <span class="p">[</span><span class="s2">&quot;insignific&quot;</span><span class="p">,</span> <span class="s2">&quot;moderate&quot;</span><span class="p">,</span> <span class="s2">&quot;heavy&quot;</span><span class="p">,</span> <span class="s2">&quot;complete&quot;</span><span class="p">])</span>
<span class="n">mc</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;failure_state_keys&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;complete&quot;</span><span class="p">,</span> <span class="s2">&quot;heavy&quot;</span><span class="p">,</span> <span class="s2">&quot;moderate&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mc</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the Monte Carlo Simulation module to obtain the building failure probabilities. The building failure</span>
                   <span class="c1"># probabilities herein only consider the physical damage without the interdependency.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</div>
<div class="section" id="3.2.-Building-Damage-Spatial-Distribution-Results">
<h2>3.2. Building Damage Spatial Distribution Results<a class="headerlink" href="#3.2.-Building-Damage-Spatial-Distribution-Results" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Images/Building damage spatial results.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>   <span class="c1"># The layout of the building damage spatial distribution results shown in GIS software.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x1580925c0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_49_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_49_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shp_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;joplin_bldg_inventory_v6_LW/joplin_bldg_inventory_v6.shp&#39;</span><span class="p">)</span>
<span class="n">blgs</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shp_path</span><span class="p">)</span>
<span class="n">blgs</span> <span class="o">=</span> <span class="n">blgs</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">blgs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;failure&#39;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1"># The layout of the building damage spatial distribution results shown in Python.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/diegoc/.local/lib/python3.7/site-packages/pyproj/transformer.py:92: UserWarning:

`from_crs` is deprecated and will be removed in 2.2.0. Please use `from_proj` instead.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_50_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_50_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="4.-Infrastructure-Functionality-Analysis">
<h1>4. Infrastructure Functionality Analysis<a class="headerlink" href="#4.-Infrastructure-Functionality-Analysis" title="Permalink to this headline">¶</a></h1>
<p>The functionality analysis module below can be used to calculate building functionality probabilities considering two situations: buildings are in at least a damage state 2 or greater or buildings are not damaged but electric power is not available to the building. Whether buildings can receive electrical power is assumed to depend on the interdependency between buildings and substations, and between buildings and poles in close proximity. If both the nearest pole to the building and the
substation where buildings belong to its service area are functional, buildings are considered to be able to receive electric power.</p>
<div class="section" id="4.1.-Building-Functionality-Probability">
<h2>4.1. Building Functionality Probability<a class="headerlink" href="#4.1.-Building-Functionality-Probability" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.buildingfunctionality.buildingfunctionality</span> <span class="k">import</span> <span class="n">BuildingFunctionality</span>
                                            <span class="c1"># Import building functionality module integrated into Pyincore.</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bldg_func</span> <span class="o">=</span> <span class="n">BuildingFunctionality</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="n">bldg_func</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;building_damage_mcs_samples&quot;</span><span class="p">,</span> <span class="s2">&quot;5ddc40dfb9219c06d4e28b71&quot;</span><span class="p">)</span>
<span class="n">bldg_func</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;substations_damage_mcs_samples&quot;</span><span class="p">,</span> <span class="s2">&quot;5ddc4255b9219c06d4e38a47&quot;</span><span class="p">)</span>
<span class="n">bldg_func</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;poles_damage_mcs_samples&quot;</span><span class="p">,</span> <span class="s2">&quot;5ddc42cdb9219c06d4e488e9&quot;</span><span class="p">)</span>
   <span class="c1"># Load the datasets of building samples, substation samples, and pole samples. All of the samples are randomly generated</span>
   <span class="c1"># using the Monte Carlo Simulation module introduced in the previous section.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset already exists locally. Reading from local cache.
Dataset already exists locally. Reading from local cache.
Dataset already exists locally. Reading from local cache.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bldg_func</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;interdependency_dictionary&quot;</span><span class="p">,</span> <span class="s2">&quot;5dcf4a34b9219ca5e4118312&quot;</span><span class="p">)</span>
   <span class="c1"># Load the datasets of the interdependency table between buildings and substations, and between buildings and poles.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset already exists locally. Reading from local cache.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bldg_func</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="s2">&quot;Joplin_mcs_functionality_probability&quot;</span><span class="p">)</span>
<span class="n">bldg_func</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;num_samples&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>   <span class="c1"># Define the result name, and choose the number</span>
                                         <span class="c1"># of CPU locally to run the model parallelly.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">bldg_func</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>  <span class="c1"># Run the module to obtain the building functionality probabilities.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</div>
<div class="section" id="4.2.-Building-Functionality-Spatial-Distribution-Results">
<h2>4.2. Building Functionality Spatial Distribution Results<a class="headerlink" href="#4.2.-Building-Functionality-Spatial-Distribution-Results" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">img</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;Images/Building functionality spatial results.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>   <span class="c1"># The layout of the building functionality spatial distribution results shown in GIS software.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x1592d3f28&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_60_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_60_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">shp_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;joplin_bldg_inventory_v6_LW/joplin_bldg_inventory_v6.shp&#39;</span><span class="p">)</span>
<span class="n">blgs</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">shp_path</span><span class="p">)</span>
<span class="n">blgs</span> <span class="o">=</span> <span class="n">blgs</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">blgs</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;fun&#39;</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">add_basemap</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>   <span class="c1"># The layout of the building functionality spatial distribution results shown in Python.</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/diegoc/.local/lib/python3.7/site-packages/pyproj/transformer.py:92: UserWarning:

`from_crs` is deprecated and will be removed in 2.2.0. Please use `from_proj` instead.

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_61_1.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_61_1.png" />
</div>
</div>
</div>
<div class="section" id="4.3-Physical-Service-Resilience-Metrics">
<h2>4.3 Physical Service Resilience Metrics<a class="headerlink" href="#4.3-Physical-Service-Resilience-Metrics" title="Permalink to this headline">¶</a></h2>
<p>After finding the damage level for each component (buildings, substations, and poles) based on the components’ fragility curves, their intrinsic failure status is expressed as a binary format with either failed (0) or not-failed (1). Then the failure status of all the buildings is updated by considering their dependencies with the corresponding electric power facilities. Each component generates 500 samples randomly with their failure status determined, and the percentage of building functional
and nonfunctional could be calculated using the updated status of the same sample (such as sample #1) for all the buildings, illustrated herein as an example.</p>
<p>The percent shown in the horizontal bar below refers to the number of nonfunctional/damaged buildings divided by all buildings in Joplin. For example, the mean percentage of building nonfunctional is 51.92%, and the standard deviation percentage is 0.88 % shown as an error bar. The percentage is two times more than the percent of building in damage is because three substations fall within the tornado path. Consequently, there is a significant probability for buildings located in their service
area cannot be available to access the electric power even though some buildings themselves are still safe and operational in the immediate response of the tornado hazard. It is worthy to note that a random tornado path analysis will produce a larger standard deviation of building damage and building functionality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;Results/physical-service.csv&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">infra</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Percent of building nonfunctional&#39;</span><span class="p">,</span> <span class="s1">&#39;Percent of building in damage&#39;</span><span class="p">,</span> <span class="s1">&#39;Percent of substation in damage&#39;</span><span class="p">,</span>\
         <span class="s1">&#39;Percent of pole in damage&#39;</span><span class="p">)</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">infra</span><span class="p">))</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">ps</span><span class="p">[</span><span class="s1">&#39;percentage&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">ps</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">infra</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Failures to Infrastructure&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Physical Service Resilience Metrics Percentage Change&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Physical service resilience metrics percentage change immediately after the simulated EF-5 tornado.</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_64_0.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_64_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="5.-Economic-analysis">
<h1>5. Economic analysis<a class="headerlink" href="#5.-Economic-analysis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="5.1.-Computable-General-Equilibrium-(CGE)-Model">
<h2>5.1. Computable General Equilibrium (CGE) Model<a class="headerlink" href="#5.1.-Computable-General-Equilibrium-(CGE)-Model" title="Permalink to this headline">¶</a></h2>
<p>A computable general equilibrium (CGE) model is based on fundamental economic principles. A CGE model uses multiple data sources to model the interactions of households, firms and relevant government entities as they contribute to economic activity. The model is based on (1) utility-maximizing households that supply labor and capital, using the proceeds to pay for goods and services (both locally produced and imported) and taxes; (2) the production sector, with perfectly competitive,
profit-maximizing firms using intermediate inputs, capital, land and labor to produce goods and services for both domestic consumption and export; (3) the government sector that collects taxes and uses tax revenues in order to finance the provision of public services; and (4) the rest of the world.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.joplincgeanalysis</span> <span class="k">import</span> <span class="n">JoplinCGEModel</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">joplin_cge</span> <span class="o">=</span> <span class="n">JoplinCGEModel</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Each of the objects with string IDs below refer to datasets used as inputs in the CGE model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># SAM</span>
<span class="c1"># Social accounting matrix (SAM) contains data for firms, households and government which are organized</span>
<span class="c1"># in a way to represent the interactions of all three entities in a typical economy</span>
<span class="n">SAM</span> <span class="o">=</span> <span class="s2">&quot;5dd85ae7b9219c06d4da8de4&quot;</span>

<span class="c1"># CAPITAL COMP</span>
<span class="c1"># BB is a matrix which describes how investment in physical infrastructure is transformed into functioning capital such as commercial and residential buildings.</span>
<span class="c1"># These data are collected from the Bureau of Economic Analysis (BEA).</span>
<span class="n">BB</span> <span class="o">=</span> <span class="s2">&quot;5dc1e620b9219c06dd2f473a&quot;</span>

<span class="n">IOUT</span> <span class="o">=</span> <span class="s2">&quot;5dc1e6d8b9219c06dd2f475e&quot;</span> <span class="c1"># This is matrix that describes the transfer of tax revenue collected by the local government to help finance local government expenditures. \n&quot;,</span>
<span class="n">MISC</span> <span class="o">=</span> <span class="s2">&quot;5dc1e736b9219c06dd2f4782&quot;</span> <span class="c1"># This is the name of a file that contains data for commercial sector employment and physical capital. It also contains data for the number of households and working households in the economy. \n&quot;,</span>
<span class="n">MISCH</span> <span class="o">=</span> <span class="s2">&quot;5dc1e7b5b9219c06dd2f47a6&quot;</span> <span class="c1"># A file that contains elasticities for the supply of labor with respect to paying income taxes.\n&quot;,</span>
<span class="n">LANDCAP</span> <span class="o">=</span> <span class="s2">&quot;5dc1e810b9219c06dd2f47ca&quot;</span> <span class="c1"># Contains information regarding elasticity values for the response of changes in the price of physical capital with respect to the supply of investment.\n&quot;,</span>
<span class="n">EMPLOY</span> <span class="o">=</span> <span class="s2">&quot;5dc1e85ab9219c06dd2f47ee&quot;</span> <span class="c1"># Table name containing data for commercial sector employment.\n&quot;,</span>
<span class="n">IGTD</span> <span class="o">=</span> <span class="s2">&quot;5dc1e895b9219c06dd2f4812&quot;</span> <span class="c1"># This variable represents a matrix describing the transfer of taxes collected to a variable which permits governments to spend the tax revenue on workers and intermediate inputs.\n&quot;,</span>
<span class="n">TAUFF</span> <span class="o">=</span> <span class="s2">&quot;5dc1e8eeb9219c06dd2f4836&quot;</span> <span class="c1"># Represents social security tax rates\n&quot;,</span>
<span class="n">JOBCR</span> <span class="o">=</span> <span class="s2">&quot;5dc1e962b9219c06dd2f487e&quot;</span> <span class="c1"># This is a matrix describing the supply of workers coming from each household group in the economy. \n&quot;,</span>
<span class="n">OUTCR</span> <span class="o">=</span> <span class="s2">&quot;5dc1e9aeb9219c06dd2f48bc&quot;</span> <span class="c1"># This a matrix describing the number of workers who live in Joplin but commute outside of town to work.\n&quot;,</span>
<span class="n">sector_shocks</span> <span class="o">=</span> <span class="s2">&quot;5dd84292b9219c06d4da8c93&quot;</span> <span class="c1"># This is the aggregation of building functionality states to capital shocks per sector.\n&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set analysis input datasets</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;SAM&quot;</span><span class="p">,</span> <span class="n">SAM</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;BB&quot;</span><span class="p">,</span> <span class="n">BB</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;IOUT&quot;</span><span class="p">,</span> <span class="n">IOUT</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;MISC&quot;</span><span class="p">,</span> <span class="n">MISC</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;MISCH&quot;</span><span class="p">,</span> <span class="n">MISCH</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;LANDCAP&quot;</span><span class="p">,</span> <span class="n">LANDCAP</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;EMPLOY&quot;</span><span class="p">,</span> <span class="n">EMPLOY</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;IGTD&quot;</span><span class="p">,</span> <span class="n">IGTD</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;TAUFF&quot;</span><span class="p">,</span> <span class="n">TAUFF</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;JOBCR&quot;</span><span class="p">,</span> <span class="n">JOBCR</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;OUTCR&quot;</span><span class="p">,</span> <span class="n">OUTCR</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;sector_shocks&quot;</span><span class="p">,</span> <span class="n">sector_shocks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The solver_path variable points to the absolute path for where the ipopt solver is installed. To know the absolute path of the ipopt solver in your local machine, open a terminal window, activate your pyIncore environment, and run the following command according to your OS: * on Mac: open a terminal window, activate your conda environment and type “which ipopt”. Paste the resulting path below. * on Windows: open a command terminal, activate your conda environment and type “whereipopt”. Paste
the resulting path below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set analysis parameters</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;solver_path&quot;</span><span class="p">,</span> <span class="s2">&quot;ipopt&quot;</span><span class="p">)</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;model_iterations&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Run Joplin CGE model analysis</span>
<span class="n">joplin_cge</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/diegoc/.local/lib/python3.7/site-packages/pandas/core/indexing.py:1494: FutureWarning:


Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/indexing.html#deprecate-loc-reindex-listlike

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ipopt 3.12.12:

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************

This is Ipopt version 3.12.12, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).

Too few degrees of freedom (n_x = 490, n_c = 528).
  Trying fixed_variable_treatment = RELAX_BOUNDS

Number of nonzeros in equality constraint Jacobian...:     2890
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     3366

Total number of variables............................:      687
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      687
                     variables with only upper bounds:        0
Total number of equality constraints.................:      528
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.7091136e+03 2.47e+02 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.7091147e+03 8.21e+00 2.00e+01  -1.0 3.92e+00    -  9.83e-01 9.90e-01h  1
   2 -1.7091222e+03 8.49e-02 4.91e+03  -1.0 5.90e+00    -  9.90e-01 9.90e-01h  1
   3 -1.7091223e+03 2.49e-06 5.18e+06  -1.0 2.69e+02    -  9.90e-01 1.00e+00h  1
   4 -1.7091223e+03 2.73e-12 1.55e+07  -1.0 2.23e+02    -  9.90e-01 1.00e+00f  1
   5 -1.7091223e+03 1.82e-12 5.80e+04  -1.0 1.86e+00    -  9.91e-01 1.00e+00f  1
   6 -1.7091223e+03 3.64e-12 1.80e-02  -1.0 1.55e-04    -  1.00e+00 1.00e+00h  1
   7 -1.7091223e+03 9.09e-12 1.04e-01  -8.6 3.33e-12    -  1.00e+00 1.00e+00h  1
   8 -1.7091223e+03 4.37e-11 2.10e-12  -8.6 1.16e-06    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 8

                                   (scaled)                 (unscaled)
Objective...............:  -1.7091223190879671e+03   -1.7091223190879671e+03
Dual infeasibility......:   2.0960378795115521e-12    2.0960378795115521e-12
Constraint violation....:   4.3655745685100555e-11    4.3655745685100555e-11
Complementarity.........:   4.3855530815865933e-09    4.3855530815865933e-09
Overall NLP error.......:   4.3855530815865933e-09    4.3855530815865933e-09


Number of objective function evaluations             = 9
Number of objective gradient evaluations             = 9
Number of equality constraint evaluations            = 9
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 9
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 8
Total CPU secs in IPOPT (w/o function evaluations)   =      0.253
Total CPU secs in NLP function evaluations           =      0.012

EXIT: Optimal Solution Found.
Ipopt 3.12.12: warm_start_init_point=yes
warm_start_bound_push=1e-06
warm_start_mult_bound_push=1e-06
mu_init=1e-06


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************

This is Ipopt version 3.12.12, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).

Too few degrees of freedom (n_x = 490, n_c = 528).
  Trying fixed_variable_treatment = RELAX_BOUNDS

Number of nonzeros in equality constraint Jacobian...:     2890
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     3366

Total number of variables............................:      687
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      687
                     variables with only upper bounds:        0
Total number of equality constraints.................:      528
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.7091223e+03 9.98e-07 1.00e-06  -6.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.7091223e+03 3.27e-11 9.97e-07  -6.0 9.90e-07    -  1.00e+00 1.00e+00h  1
   2 -1.7091223e+03 1.27e-11 2.42e-07  -6.0 8.01e-07    -  1.00e+00 1.00e+00f  1
   3 -1.7091223e+03 2.91e-11 2.27e-01  -9.0 4.10e-09    -  9.98e-01 1.00e+00h  1
   4 -1.7091223e+03 5.82e-11 1.10e-12  -9.0 1.23e-06    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 4

                                   (scaled)                 (unscaled)
Objective...............:  -1.7091223190976707e+03   -1.7091223190976707e+03
Dual infeasibility......:   1.0965805839350968e-12    1.0965805839350968e-12
Constraint violation....:   5.8207660913467407e-11    5.8207660913467407e-11
Complementarity.........:   1.9823428539280810e-09    1.9823428539280810e-09
Overall NLP error.......:   1.9823428539280810e-09    1.9823428539280810e-09


Number of objective function evaluations             = 5
Number of objective gradient evaluations             = 5
Number of equality constraint evaluations            = 5
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 5
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 4
Total CPU secs in IPOPT (w/o function evaluations)   =      0.100
Total CPU secs in NLP function evaluations           =      0.006

EXIT: Optimal Solution Found.
Ipopt 3.12.12:

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************

This is Ipopt version 3.12.12, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).

Too few degrees of freedom (n_x = 490, n_c = 528).
  Trying fixed_variable_treatment = RELAX_BOUNDS

Number of nonzeros in equality constraint Jacobian...:     2890
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     3366

Total number of variables............................:      687
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      687
                     variables with only upper bounds:        0
Total number of equality constraints.................:      528
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.7091136e+03 6.93e+02 1.00e+00  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.6659840e+03 4.04e+02 5.39e+02  -1.0 9.23e+02    -  3.94e-01 4.17e-01h  1
   2 -1.6231663e+03 8.75e+01 9.67e+01  -1.0 5.66e+02    -  5.97e-01 7.84e-01h  1
   3 -1.6132322e+03 1.10e+01 2.89e+02  -1.0 1.57e+02    -  9.21e-01 8.75e-01h  1
   4 -1.6121246e+03 2.71e-01 3.32e+03  -1.0 2.77e+01    -  9.90e-01 9.75e-01h  1
   5 -1.6121239e+03 2.02e-03 1.37e+06  -1.0 2.51e+02    -  9.90e-01 9.93e-01h  1
   6 -1.6121240e+03 1.52e-08 4.91e+06  -1.0 2.42e+02    -  9.90e-01 1.00e+00h  1
   7 -1.6121240e+03 1.82e-12 5.13e+04  -1.0 2.33e+00    -  9.93e-01 1.00e+00h  1
   8 -1.6121240e+03 1.82e-12 5.24e-03  -1.0 2.25e-04    -  1.00e+00 1.00e+00h  1
   9 -1.6121240e+03 3.64e-12 3.73e-01  -8.6 2.56e-12    -  1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10 -1.6121240e+03 5.46e-11 1.03e-12  -8.6 1.27e-06    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 10

                                   (scaled)                 (unscaled)
Objective...............:  -1.6121239798417676e+03   -1.6121239798417676e+03
Dual infeasibility......:   1.0260383928696605e-12    1.0260383928696605e-12
Constraint violation....:   5.4569682106375694e-11    5.4569682106375694e-11
Complementarity.........:   4.4397848633184868e-09    4.4397848633184868e-09
Overall NLP error.......:   4.4397848633184868e-09    4.4397848633184868e-09


Number of objective function evaluations             = 11
Number of objective gradient evaluations             = 11
Number of equality constraint evaluations            = 11
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 11
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 10
Total CPU secs in IPOPT (w/o function evaluations)   =      0.246
Total CPU secs in NLP function evaluations           =      0.014

EXIT: Optimal Solution Found.
Ipopt 3.12.12: warm_start_init_point=yes
warm_start_bound_push=1e-06
warm_start_mult_bound_push=1e-06
mu_init=1e-06


******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************

This is Ipopt version 3.12.12, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).

Too few degrees of freedom (n_x = 490, n_c = 528).
  Trying fixed_variable_treatment = RELAX_BOUNDS

Number of nonzeros in equality constraint Jacobian...:     2890
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     3366

Total number of variables............................:      687
                     variables with only lower bounds:        0
                variables with lower and upper bounds:      687
                     variables with only upper bounds:        0
Total number of equality constraints.................:      528
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0 -1.6121240e+03 1.56e-06 1.00e-06  -6.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1 -1.6121240e+03 1.55e-11 9.97e-07  -6.0 9.90e-07    -  1.00e+00 1.00e+00h  1
   2 -1.6121240e+03 2.00e-11 5.41e-07  -6.0 1.20e-06    -  1.00e+00 1.00e+00f  1
   3 -1.6121240e+03 3.91e-11 4.90e-01  -9.0 7.92e-09    -  9.95e-01 1.00e+00h  1
   4 -1.6121240e+03 3.00e-11 5.37e-02  -9.0 1.31e-06    -  8.90e-01 1.00e+00h  1
   5 -1.6121240e+03 6.00e-11 2.65e-12  -9.0 2.99e-07    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 5

                                   (scaled)                 (unscaled)
Objective...............:  -1.6121239798995996e+03   -1.6121239798995996e+03
Dual infeasibility......:   2.6457711949598466e-12    2.6457711949598466e-12
Constraint violation....:   6.0026650317013264e-11    6.0026650317013264e-11
Complementarity.........:   1.2243827276411417e-09    1.2243827276411417e-09
Overall NLP error.......:   1.2243827276411417e-09    1.2243827276411417e-09


Number of objective function evaluations             = 6
Number of objective gradient evaluations             = 6
Number of equality constraint evaluations            = 6
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 6
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 5
Total CPU secs in IPOPT (w/o function evaluations)   =      0.132
Total CPU secs in NLP function evaluations           =      0.008

EXIT: Optimal Solution Found.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</div>
<div class="section" id="5.2.-Economic-Resilience-Metrics">
<h2>5.2. Economic Resilience Metrics<a class="headerlink" href="#5.2.-Economic-Resilience-Metrics" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="Percent-Reduction-of-Domestic-Supply">
<h2><em>Percent Reduction of Domestic Supply</em><a class="headerlink" href="#Percent-Reduction-of-Domestic-Supply" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;Results/domestic-supply.csv&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">sectors</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Goods&#39;</span><span class="p">,</span> <span class="s1">&#39;Trades&#39;</span><span class="p">,</span> <span class="s1">&#39;Others&#39;</span><span class="p">,</span> <span class="s1">&#39;Housing service 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Housing service 2&#39;</span><span class="p">,</span><span class="s1">&#39;Housing service 3&#39;</span><span class="p">)</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sectors</span><span class="p">))</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;percentage&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">sectors</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Percent reduction of domestic supply (%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Economic Resilience Metrics Percentage Change&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_78_0.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_78_0.png" />
</div>
</div>
</div>
<div class="section" id="Percent-Reduction-of-Household-Income">
<h2><em>Percent Reduction of Household Income</em><a class="headerlink" href="#Percent-Reduction-of-Household-Income" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">hi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;Results/household-income.csv&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">household</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;HH1 (less than $15,000)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH2 ($15,000 to 24,999)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH3 ($25,000 to 74,999)&#39;</span><span class="p">,</span> \
           <span class="s1">&#39;HH4 ($75,000 to 99,999)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH5 ($100,000 or more)&#39;</span><span class="p">)</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">household</span><span class="p">))</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">hi</span><span class="p">[</span><span class="s1">&#39;percentage&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span><span class="mi">1</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">household</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Percent reduction of household income (%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Economic Resilience Metrics Percentage Change&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_80_0.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_80_0.png" />
</div>
</div>
</div>
<div class="section" id="Percent-Reduction-of-Employment">
<h2><em>Percent Reduction of Employment</em><a class="headerlink" href="#Percent-Reduction-of-Employment" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">em</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;Results/employment.csv&#39;</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">household</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;HH1 (less than $15,000)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH2 ($15,000 to 24,999)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH3 ($25,000 to 74,999)&#39;</span><span class="p">,</span> \
           <span class="s1">&#39;HH4 ($75,000 to 99,999)&#39;</span><span class="p">,</span> <span class="s1">&#39;HH5 ($100,000 or more)&#39;</span><span class="p">)</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">household</span><span class="p">))</span>
<span class="n">performance</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="s1">&#39;percentage&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">household</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Percent reduction of employment (%)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Economic Resilience Metrics Percentage Change&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_82_0.png" src="../_images/notebooks_Joplin_Tornado_Juypter_Notebook_Example_82_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="6.-Sociological-Analysis">
<h1>6. Sociological Analysis<a class="headerlink" href="#6.-Sociological-Analysis" title="Permalink to this headline">¶</a></h1>
<p>This section introduces the sociology-based analysis which may be integrated with hazard and building damage analysis. In this example the damage to buildings drives the population dislocation algorithm at the household level.</p>
<div class="section" id="6.1.-Population-Dislocation-Model">
<h2>6.1. Population Dislocation Model<a class="headerlink" href="#6.1.-Population-Dislocation-Model" title="Permalink to this headline">¶</a></h2>
<p>The population dislocation model depends first on the allocation of detailed housing unit and household characteristic data to each residential building within the community. The allocation of detailed household characteristic data provides an estimate of the number of people that live within each structure. The dislocation model is based on household surveys, for a more detailed summary of the dislocation model please refer to Rosenheim, Guidotti, Gardoni, and Peacock 2019.</p>
<p>The model predicts which households within the community will be dislocated from their homes immediately following the hazard event.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyincore.analyses.populationdislocation</span> <span class="k">import</span> <span class="n">PopulationDislocation</span><span class="p">,</span> <span class="n">PopulationDislocationUtil</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pop_dis</span> <span class="o">=</span> <span class="n">PopulationDislocation</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Joplin</span>
<span class="n">building_dmg</span> <span class="o">=</span> <span class="s2">&quot;5dbc9525b9219c06dd282637&quot;</span>
<span class="n">housing_unit_alloc</span> <span class="o">=</span> <span class="s2">&quot;5dc1c196b9219c06dd2e3f0b&quot;</span>
<span class="n">bg_data</span> <span class="o">=</span> <span class="s2">&quot;5d4c9545b9219c0689b2358a&quot;</span>
<span class="n">value_loss</span> <span class="o">=</span> <span class="s2">&quot;5dfd1069fc33d500081555d8&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pop_dis</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;building_dmg&quot;</span><span class="p">,</span> <span class="n">building_dmg</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;housing_unit_allocation&quot;</span><span class="p">,</span> <span class="n">housing_unit_alloc</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;block_group_data&quot;</span><span class="p">,</span> <span class="n">bg_data</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">load_remote_input_dataset</span><span class="p">(</span><span class="s2">&quot;value_poss_param&quot;</span><span class="p">,</span> <span class="n">value_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset already exists locally. Reading from local cache.
Dataset already exists locally. Reading from local cache.
Dataset already exists locally. Reading from local cache.
Dataset already exists locally. Reading from local cache.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">result_name</span> <span class="o">=</span> <span class="s2">&quot;pop-dislocation-results&quot;</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">1111</span>

<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;result_name&quot;</span><span class="p">,</span> <span class="n">result_name</span><span class="p">)</span>
<span class="n">pop_dis</span><span class="o">.</span><span class="n">set_parameter</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pop_dis</span><span class="o">.</span><span class="n">run_analysis</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
</div>
<div class="section" id="6.2.-Sociological-Resilience-Metrics">
<h2>6.2. Sociological Resilience Metrics<a class="headerlink" href="#6.2.-Sociological-Resilience-Metrics" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="Percent-of-Population-Dislocation">
<h2><em>Percent of Population Dislocation</em><a class="headerlink" href="#Percent-of-Population-Dislocation" title="Permalink to this headline">¶</a></h2>
<p>The PopulationDislocation model predicts the probability of dislocation using a logistic regression model based on household level surveys from Hurricane Andrew in 1992, which was a major wind event. The logistic regression equation provides a probability of dislocation based on the value loss and the other factors. For more details on the population dislocation algorithm and the logistic regression model see Rosenheim et al 2019.</p>
<p>To determine if a household dislocate a random value was uniformly sampled between 0 and 1: if this value was lower than the probability of dislocation, then the household was set to dislocate. The results below provide one example of how the output can be explored by population subgroups. The model is designed to run as part of a larger Monte Carlo Simulation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">population_dislocation</span> <span class="o">=</span> <span class="n">pop_dis</span><span class="o">.</span><span class="n">get_output_dataset</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">)</span>
<span class="c1"># Convert dataset to Pandas DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">population_dislocation</span><span class="o">.</span><span class="n">get_dataframe_from_csv</span><span class="p">()</span>

<span class="c1"># Select Housing units allocated to buildings</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;archtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/miniconda3/envs/cge/lib/python3.7/site-packages/IPython/core/interactiveshell.py:3214: DtypeWarning:

Columns (0,5,9,10,11,53) have mixed types. Specify dtype option on import or set low_memory=False.

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table_title</span> <span class="o">=</span> <span class="s2">&quot;Total population by tenure status and dislocation.&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ownershp&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dislocated&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;numprec&#39;</span><span class="p">],</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">,</span>
            <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins_name</span><span class="o">=</span><span class="s2">&quot;Total&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="n">table_title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_04f8b81a_2367_11ea_822b_acde48001122" ><caption>Total population by tenure status and dislocation.</caption><thead>    <tr>        <th class="index_name level0" >dislocated</th>        <th class="col_heading level0 col0" >False</th>        <th class="col_heading level0 col1" >True</th>        <th class="col_heading level0 col2" >Total</th>    </tr>    <tr>        <th class="index_name level0" >ownershp</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_04f8b81a_2367_11ea_822b_acde48001122level0_row0" class="row_heading level0 row0" >1.0</th>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row0_col0" class="data row0 col0" >18466</td>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row0_col1" class="data row0 col1" >12645</td>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row0_col2" class="data row0 col2" >31111</td>
            </tr>
            <tr>
                        <th id="T_04f8b81a_2367_11ea_822b_acde48001122level0_row1" class="row_heading level0 row1" >2.0</th>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row1_col0" class="data row1 col0" >14135</td>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row1_col1" class="data row1 col1" >8833</td>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row1_col2" class="data row1 col2" >22968</td>
            </tr>
            <tr>
                        <th id="T_04f8b81a_2367_11ea_822b_acde48001122level0_row2" class="row_heading level0 row2" >Total</th>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row2_col0" class="data row2 col0" >32601</td>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row2_col1" class="data row2 col1" >21478</td>
                        <td id="T_04f8b81a_2367_11ea_822b_acde48001122row2_col2" class="data row2 col2" >54079</td>
            </tr>
    </tbody></table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">table_title</span> <span class="o">=</span> <span class="s2">&quot;Percent population by tenure status and dislocation.&quot;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ownershp&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;dislocated&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;numprec&#39;</span><span class="p">],</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
            <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins_name</span><span class="o">=</span><span class="s2">&quot;Total&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>dislocated</th>
      <th>False</th>
      <th>True</th>
    </tr>
    <tr>
      <th>ownershp</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>59.36</td>
      <td>40.64</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>61.54</td>
      <td>38.46</td>
    </tr>
    <tr>
      <th>Total</th>
      <td>60.28</td>
      <td>39.72</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The variable ownershp represents the tenure status of households. When ownershp = 1 the housing unit is owner-occupied. When the ownershp = 2 the housing unit is renter-occupied. The results above provide the percent of the population predicted to dislocate based on tenure status. When the variable dislocated = True the household is predicted to dislocate.</p>
</div>
</div>
<div class="section" id="7.-References">
<h1>7. References<a class="headerlink" href="#7.-References" title="Permalink to this headline">¶</a></h1>
<p>Attary, N., van de Lindt, J. W., Mahmoud, H., Smith, S., Navarro, C. M., Kim, Y. W., &amp; Lee, J. S. (2018). Hindcasting community-level building damage for the 2011 Joplin EF5 tornado. Natural Hazards, 93(3), 1295-1316.</p>
<p>Attary, N., van de Lindt, J. W., Mahmoud, H., &amp; Smith, S. (2018). Hindcasting Community-Level Damage to the Interdependent Buildings and Electric Power Network after the 2011 Joplin, Missouri, Tornado. Natural Hazards Review, 20(1), 04018027.</p>
<p>Memari, M., Attary, N., Masoomi, H., Mahmoud, H., van de Lindt, J. W., Pilkington, S. F., &amp; Ameri, M. R. (2018). Minimal building fragility portfolio for damage assessment of communities subjected to tornadoes. Journal of Structural Engineering, 144(7), 04018072.</p>
<p>Guidotti, R., Gardoni, P., &amp; Rosenheim, N. (2019). Integration of physical infrastructure and social systems in communities’ reliability and resilience analysis. Reliability Engineering &amp; System Safety, 185, 476-492. <a class="reference external" href="https://doi.org/10.1016/j.ress.2019.01.008">https://doi.org/10.1016/j.ress.2019.01.008</a></p>
<p>Rosenheim, N., Guidotti, R., Gardoni, P., &amp; Peacock, W. (2019). Integration of detailed household and housing unit characteristic data with critical infrastructure for post-hazard resilience modeling. Sustainable and Resilient Infrastructure. <a class="reference external" href="https://doi.org/10.1080/23789689.2019.1681821">https://doi.org/10.1080/23789689.2019.1681821</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Notebook1_SeasideBuildingDamage.html" class="btn btn-neutral float-right" title="Seaside Example Notebook 1: Multi-Hazard Building Damage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../notebooks.html" class="btn btn-neutral float-left" title="Example Notebooks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>